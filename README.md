# 音訊轉錄工具

本專案旨在自動監控指定資料夾，偵測新增的音訊檔案，並利用 OpenAI Whisper API 進行高品質轉錄，同時自動生成會議摘要。本工具支援多種音訊格式（如 .mp3、.wav、.m4a、.flac），並具備自動切割大檔案、GUI 介面（含檔案清單與手動選擇製作逐字稿）、即時日誌、以及可隨時啟動/停止監控等功能。

## 功能

- **自動監控指定資料夾**：當偵測到新增的音訊檔案時，自動進行轉錄與摘要生成。
- **支援多種音訊格式**：支援 .mp3、.wav、.m4a、.flac 等常見音訊格式。
- **高品質轉錄**：利用 OpenAI Whisper API 進行高品質轉錄，並將逐字稿儲存至 transcripts 資料夾。
- **自動生成摘要**：利用 GPT-4 API 自動生成會議摘要，並將摘要儲存至 summaries 資料夾。
- **自動切割大檔案**：若音訊檔案超過設定的大小（預設 25MB），則自動切割成較小的片段（預設每段 10 分鐘），並以 mp3 格式輸出，再進行轉錄與摘要生成。
- **GUI 介面**：提供圖形化介面，包含檔案清單（顯示監控資料夾內的檔案）與「製作逐字稿」按鈕，方便手動選擇檔案進行轉錄。
- **即時日誌**：GUI 介面中即時顯示執行日誌，方便追蹤程式執行狀態。
- **可隨時啟動/停止監控**：使用者可透過 GUI 介面隨時啟動或停止監控。

## 系統需求

- Python 3.8 或以上版本
- FFmpeg（用於音訊檔案切割與轉換）
- OpenAI API 金鑰
- 本專案所需 Python 套件（詳見安裝步驟）

## 安裝步驟

1. 安裝 FFmpeg（若尚未安裝）：
   - Windows 使用者可透過 Chocolatey 安裝，請以系統管理員身分開啟 PowerShell，並執行：
     ```bash
     choco install ffmpeg
     ```
   - 安裝後，請確認 FFmpeg 已加入系統環境變數，並在命令提示字元中執行 `ffmpeg -version` 以確認安裝成功。

2. 安裝本專案所需 Python 套件：
   - 在專案根目錄下，執行以下指令：
     ```bash
     py -m pip install -r requirements.txt
     ```

3. 設定環境變數：
   - 複製 `.env.example` 為 `.env`
   - 在 `.env` 中設定您的 OpenAI API 金鑰：
     ```
     OPENAI_API_KEY=your_api_key_here
     ```

## 使用說明

### 執行方式

- **直接執行 Python 檔案**：在專案根目錄下，執行以下指令：
  ```bash
  py transcribe.py
  ```

- **打包成可執行檔**：若希望打包成 Windows 可執行檔（.exe），請執行以下指令：
  ```bash
  py -m PyInstaller --onefile --windowed --name="音訊轉錄工具" transcribe.py
  ```
  打包完成後，可於 `dist` 資料夾內找到「音訊轉錄工具.exe」，直接點擊即可執行。

### GUI 說明

- **檔案清單**：顯示監控資料夾內的檔案清單，包含檔案名稱與檔案大小（MB）。點擊「開始監控」後，檔案清單會自動更新。
- **製作逐字稿**：在檔案清單中選擇檔案後，點擊「製作逐字稿」按鈕即可開始處理。
- **即時日誌**：GUI 介面中即時顯示執行日誌，方便追蹤程式執行狀態。
- **啟動/停止監控**：使用「開始監控」和「停止監控」按鈕控制監控狀態。

### 檔案處理說明

- **自動監控**：程式會自動監控指定資料夾，偵測到新檔案時自動進行處理。
- **自動切割**：大檔案（>25MB）會自動切割成較小片段（每段 10 分鐘）後處理。
- **手動處理**：可在檔案清單中選擇檔案，點擊「製作逐字稿」按鈕手動處理。

## 常見問題

- **Q: 為什麼切割檔案時會失敗？**  
  A: 請確認 FFmpeg 已正確安裝並加入環境變數。可在命令提示字元中執行 `ffmpeg -version` 確認。

- **Q: 如何設定 OpenAI API 金鑰？**  
  A: 複製 `.env.example` 為 `.env`，並在其中設定您的 API 金鑰。

- **Q: 如何打包成可執行檔？**  
  A: 執行 `py -m PyInstaller --onefile --windowed --name="音訊轉錄工具" transcribe.py`，完成後在 `dist` 資料夾中找到執行檔。

## 授權

本專案採用 MIT 授權條款。 